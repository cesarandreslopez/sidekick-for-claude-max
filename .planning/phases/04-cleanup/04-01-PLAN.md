---
phase: 04-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - sidekick-server/ (DELETE)
  - start-server.sh (DELETE)
  - README-SERVER.md (DELETE)
  - sidekick-vscode/package.json
  - sidekick-vscode/src/extension.test.ts
autonomous: true

must_haves:
  truths:
    - "sidekick-server/ directory no longer exists"
    - "start-server.sh script no longer exists"
    - "README-SERVER.md no longer exists"
    - "serverUrl setting does not appear in VS Code settings UI"
    - "Extension tests pass without serverUrl references"
  artifacts:
    - path: "sidekick-vscode/package.json"
      provides: "Extension configuration without serverUrl setting"
      contains: "sidekick.authMode"
      not_contains: "sidekick.serverUrl"
    - path: "sidekick-vscode/src/extension.test.ts"
      provides: "Test mocks without serverUrl"
      not_contains: "serverUrl"
  key_links:
    - from: "package.json contributes.configuration.properties"
      to: "VS Code settings UI"
      via: "VS Code reads package.json"
      pattern: "sidekick\\."
---

<objective>
Delete all Python server artifacts and remove server-related configuration from the extension.

Purpose: Complete the SDK migration by removing unused server infrastructure. The TypeScript SDK now handles all Claude API calls directly - no local server needed.

Output: Clean repository with no Python server remnants in code or config.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-cleanup/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete server artifacts</name>
  <files>
    - sidekick-server/ (entire directory)
    - start-server.sh
    - README-SERVER.md
  </files>
  <action>
Delete the Python server and related files that are no longer needed:

1. Delete the entire sidekick-server/ directory:
   ```bash
   rm -rf sidekick-server/
   ```

2. Delete the server startup script:
   ```bash
   rm start-server.sh
   ```

3. Delete the server-specific README:
   ```bash
   rm README-SERVER.md
   ```

These files are completely unused after the SDK migration. The extension now uses @anthropic-ai/claude-agent-sdk directly.
  </action>
  <verify>
```bash
# All three should return "No such file or directory"
ls sidekick-server/ 2>&1 | grep -q "No such file" && echo "OK: sidekick-server deleted"
ls start-server.sh 2>&1 | grep -q "No such file" && echo "OK: start-server.sh deleted"
ls README-SERVER.md 2>&1 | grep -q "No such file" && echo "OK: README-SERVER.md deleted"
```
  </verify>
  <done>
- sidekick-server/ directory does not exist
- start-server.sh does not exist
- README-SERVER.md does not exist
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove serverUrl from extension</name>
  <files>
    - sidekick-vscode/package.json
    - sidekick-vscode/src/extension.test.ts
  </files>
  <action>
Remove the deprecated serverUrl setting and test mocks:

1. In `sidekick-vscode/package.json`, remove lines 55-59 (the sidekick.serverUrl configuration property):
   ```json
   // REMOVE THIS ENTIRE BLOCK:
   "sidekick.serverUrl": {
     "type": "string",
     "default": "http://localhost:3456",
     "description": "URL of the Sidekick server"
   },
   ```
   Make sure to also remove the trailing comma from the previous property (sidekick.authMode) if needed to maintain valid JSON.

2. In `sidekick-vscode/src/extension.test.ts`:
   - Remove line 21: `serverUrl: "http://localhost:3456",` from the defaults object in the mock
   - Remove line 73: `expect(config.get("serverUrl")).toBe("http://localhost:3456");` (the test assertion)

   Update the "should have correct default configuration values" test to not check serverUrl.
  </action>
  <verify>
```bash
# serverUrl should not appear in package.json configuration
grep -q "serverUrl" sidekick-vscode/package.json && echo "FAIL: serverUrl still in package.json" || echo "OK: serverUrl removed from package.json"

# serverUrl should not appear in test file
grep -q "serverUrl" sidekick-vscode/src/extension.test.ts && echo "FAIL: serverUrl still in tests" || echo "OK: serverUrl removed from tests"

# package.json should be valid JSON
node -e "require('./sidekick-vscode/package.json')" && echo "OK: package.json is valid JSON"

# Tests should pass
cd sidekick-vscode && npm test
```
  </verify>
  <done>
- sidekick.serverUrl not in package.json contributes.configuration.properties
- serverUrl not referenced in extension.test.ts
- package.json is valid JSON
- All extension tests pass
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. Confirm server artifacts deleted:
   ```bash
   ls sidekick-server/ start-server.sh README-SERVER.md 2>&1
   # Should show "No such file or directory" for all three
   ```

2. Confirm serverUrl completely removed:
   ```bash
   grep -r "serverUrl" sidekick-vscode/
   # Should return nothing
   ```

3. Confirm extension builds and tests pass:
   ```bash
   cd sidekick-vscode && npm run compile && npm test
   ```
</verification>

<success_criteria>
- CLEAN-01: sidekick-server/ directory deleted
- CLEAN-02: start-server.sh deleted
- CLEAN-03: serverUrl setting removed from package.json
- Extension tests pass
- Extension compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-cleanup/04-01-SUMMARY.md`
</output>
