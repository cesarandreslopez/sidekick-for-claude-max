# Milestone v1.0: SDK Migration

**Status:** ✅ SHIPPED 2026-01-21
**Phases:** 1-4
**Total Plans:** 9

## Overview

Migrate Sidekick for Max from a Python server + TypeScript extension architecture to a pure TypeScript extension using the Anthropic SDK directly. This eliminates the server dependency that users must manually start, simplifies the codebase to a single language, and provides a foundation for both API key and Max subscription authentication.

## Phases

### Phase 1: Foundation

**Goal**: Extension can make Claude API calls without Python server
**Depends on**: Nothing (first phase)
**Requirements**: INFRA-01, INFRA-02, INFRA-03, INFRA-04, INFRA-05, INFRA-06, INFRA-07
**Success Criteria** (what must be TRUE):
  1. Extension activates and initializes without any Python/server dependency
  2. User can authenticate with API key and make a test API call
  3. User can authenticate with Max subscription (via claude-agent-sdk) and make a test API call
  4. User can switch between API key and Max subscription auth in settings
  5. Extension host remains responsive during API calls (no blocking)
**Plans**: 3 plans

Plans:
- [x] 01-01-PLAN.md - Build infrastructure (esbuild, SDK dependencies)
- [x] 01-02-PLAN.md - Auth service layer (dual-auth abstraction)
- [x] 01-03-PLAN.md - Extension integration (settings, commands, wiring)

**Completed:** 2026-01-20

### Phase 2: Completions

**Goal**: User receives inline code completions as they type
**Depends on**: Phase 1
**Requirements**: COMP-01, COMP-02, COMP-03, COMP-04, COMP-05, COMP-06, COMP-07, COMP-08
**Success Criteria** (what must be TRUE):
  1. User sees ghost text completions appear after typing pauses
  2. User can accept full completion with Tab key
  3. User can accept word-by-word with Ctrl+Right
  4. Completions are cached (same context returns instant result)
  5. User can configure which model is used for completions
**Plans**: 2 plans

Plans:
- [x] 02-01-PLAN.md - CompletionService with caching, debouncing, and prompt templates
- [x] 02-02-PLAN.md - Wire InlineCompletionProvider to use CompletionService

**Completed:** 2026-01-21

### Phase 3: Transforms + UX

**Goal**: User can transform selected code and see connection status
**Depends on**: Phase 2
**Requirements**: TRANS-01, TRANS-02, TRANS-03, TRANS-04, UX-01, UX-02, UX-03, UX-04, UX-05
**Success Criteria** (what must be TRUE):
  1. User can select code, invoke transform command, enter instruction, and see result
  2. User can configure which model is used for transforms
  3. Status bar shows connection state (connected/disconnected/error)
  4. Status bar shows loading indicator during API calls
  5. Extension works in Cursor IDE without modification
**Plans**: 2 plans

Plans:
- [x] 03-01-PLAN.md - StatusBarManager service and transform prompt templates
- [x] 03-02-PLAN.md - Transform command migration to AuthService SDK

**Completed:** 2026-01-21

### Phase 4: Cleanup

**Goal**: Python server removed, documentation updated
**Depends on**: Phase 3
**Requirements**: CLEAN-01, CLEAN-02, CLEAN-03, CLEAN-04, CLEAN-05
**Success Criteria** (what must be TRUE):
  1. sidekick-server/ directory no longer exists in repository
  2. README shows new setup flow (no server to start)
  3. Extension settings have no server-related configuration
  4. CI/CD pipeline has no Python-related steps
**Plans**: 2 plans

Plans:
- [x] 04-01-PLAN.md - Delete server artifacts, remove serverUrl setting
- [x] 04-02-PLAN.md - Update documentation and CI/CD

**Completed:** 2026-01-21

---

## Milestone Summary

**Key Decisions:**

- Use @anthropic-ai/sdk for API key auth, @anthropic-ai/claude-agent-sdk for Max subscription
- Both auth modes supported with user toggle (not one-or-the-other)
- esbuild for bundling, tsc only for type checking (noEmit: true)
- CommonJS format for VS Code extension compatibility
- Max subscription as default auth mode (leverages existing Claude Max subscription)
- Lazy client initialization (only create client when first needed)
- Native Map for LRU cache (preserves insertion order, O(1) operations)
- Request ID tracking for stale request detection after async operations
- StatusBarManager starts in connected state (extension enabled by default)

**Issues Resolved:**

- Eliminated Python server dependency completely
- Fixed outdated documentation referencing server architecture
- Removed serverUrl setting from package.json and tests

**Issues Deferred:**

- Streaming completions (v2 ADV-01)
- Token usage statistics (v2 ADV-02)
- Per-workspace model configuration (v2 ADV-03)

**Technical Debt Incurred:**

- None significant — clean migration

---

_For current project status, see .planning/ROADMAP.md_
